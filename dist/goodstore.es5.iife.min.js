var goodstore=function(e,t,o){"use strict";var r=function(){function e(e,o){this._fixedLoadPort=new t.Range2,this._fixedPxLoadPort=new t.Range2,this.totalCells=new t.Vec2(-1,-1),this.totalPx=new t.Vec2(-1,-1),this._config=e,this._stream=o,this.fetchSubscription=null,this.ignoreFetch=-1,this.requestId=-1}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},set:function(e){this._config=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stream",{get:function(){return this._stream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadPort",{get:function(){return this.config.loadPort},set:function(e){this.config.loadPort=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxLoadPort",{get:function(){return this.config.pxLoadPort},set:function(e){this.config.pxLoadPort=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fixedLoadPort",{get:function(){return this._fixedLoadPort},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fixedPxLoadPort",{get:function(){return this._fixedLoadPort},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewPort",{get:function(){return this.config.viewPort},set:function(e){this.config.viewPort.equals(e)||this.ignoreOngoingFetch(),this.config.viewPort=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxViewPort",{get:function(){return this.config.pxViewPort},set:function(e){this.config.pxViewPort.equals(e)||this.ignoreOngoingFetch(),this.config.pxViewPort=e},enumerable:!0,configurable:!0}),e.prototype.fixLoadPort=function(){this.config.pxLoadPort.isZero?(this._fixedLoadPort.set(this.config.loadPort),this._fixedPxLoadPort.zero()):(this._fixedPxLoadPort.set(this.config.pxLoadPort),this._fixedLoadPort.zero())},e.prototype.ignoreOngoingFetch=function(){null!==this.fetchSubscription&&(this.ignoreFetch=this.requestId)},e.prototype.cancelOngoingFetch=function(){null!==this.fetchSubscription&&(this.fetchSubscription.unsubscribe(),this.fetchSubscription=null)},e.prototype.limitLoadPortByTotalCells=function(){this.limitPortByTotal(this.loadPort,this.totalCells)},e.prototype.limitPxLoadPortByTotalPx=function(){this.limitPortByTotal(this.pxLoadPort,this.totalPx)},e.prototype.limitPortByTotal=function(e,o){if(!e.isZero&&!o.equals({x:-1,y:-1})){var r=e.toRect().stop.subtract(o).max(new t.Vec2(0,0));e.size.subtract(r)}},e}(),n=function(){function e(e,t,n){this._force=!1,this._id=e,this._store=t,this._stream=new o.BehaviorSubject(null),this._internal=new r(n,this._stream)}return Object.defineProperty(e.prototype,"internal",{get:function(){return this._internal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stream",{get:function(){return this._stream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewPort",{get:function(){return this._internal.viewPort},set:function(e){this._internal.viewPort=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxViewPort",{get:function(){return this._internal.pxViewPort},set:function(e){this._internal.pxViewPort=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestMargin",{get:function(){return this._internal.config.requestMargin},set:function(e){this._internal.config.requestMargin=e},enumerable:!0,configurable:!0}),e.prototype.load=function(e){this.readConfig(e),this._store.load(this.internal,this._force)},e.prototype.unregister=function(){throw new Error("not implemented")},e.prototype.readConfig=function(e){void 0!==e&&(void 0!==e.requestMargin&&(this.internal.config.requestMargin=e.requestMargin),void 0!==e.viewPort&&(this.viewPort=e.viewPort),void 0!==e.pxViewPort&&(this.pxViewPort=e.pxViewPort),this._force=!0===e.forceStream)},e}(),i=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=function(){function e(){this.totalCells=new t.Vec2,this.totalPx=new t.Vec2,this.loadPort=null,this.pxScope=new t.Rect,this.rows=null}return e.prototype.init=function(e){throw new Error("Method not implemented.")},e=i([t.Initable],e)}(),s=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},c=function(){function e(){}return e.prototype.init=function(e){throw new Error("Method not implemented.")},e=s([t.Initable],e)}(),l=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(){function e(e){void 0===e&&(e=0),this.i=0,this.h=0,this.d=null,this.c=new Array(e)}return e.prototype.init=function(e){throw new Error("Method not implemented.")},e.prototype.release=function(){throw new Error("Method not implemented.")},e.prototype.initPool=function(e){throw new Error("Method not implemented.")},e=l([t.Poolable,t.Initable,u("design:paramtypes",[Number])],e)}(),h=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(){function e(){this._id=0,this._r=[],this._pxScope=new t.Rect,this._cellSize=new t.Vec2,this._r=new Array}return e.prototype.release=function(){throw new Error("Method not implemented.")},e.prototype.initPool=function(e){throw new Error("Method not implemented.")},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return this._r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxScope",{get:function(){return this._pxScope},set:function(e){this._pxScope.set(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSize",{get:function(){return this._cellSize},set:function(e){this._cellSize.set(e),this.initData(e)},enumerable:!0,configurable:!0}),e.prototype.addRow=function(){var e=new p;return this._r.push(e),e},e.prototype.initData=function(e){var t=-1;void 0===this._r&&(this._r=[]);for(var o=this._r,r=o.length-1,n=Math.min(r,e.y);++r<e.y;)o.push(new p(e.x));for(o.length!==e.y&&(o.length=e.y);++t<n;)o[t].c.length=e.x},e=h([t.Poolable,t.Initable,g("design:paramtypes",[])],e)}(),f=function(){function e(e,o,r){void 0===r&&(r=null),this.isDebug=!0,this._usePx=!0,this._dummyRect=new t.Rect,this._pagePool=new t.Pool(P),this._pageLookup=new t.Dictionary,this._requestedPages=new t.Dictionary,this._pageQueue=new Array,this._cellsPerPage=new t.Vec2,this._pagesPerCell=new t.Vec2,this.setPageSize(e),this._retainSize=o,this._totalPages=new t.Vec2,this._totalCells=new t.Vec2,this._totalPx=new t.Vec2,this._pagePxRanges=r,this._usePx=null!==r}return Object.defineProperty(e.prototype,"totalPx",{get:function(){return this._totalPx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalCells",{get:function(){return this._totalCells},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalPages",{get:function(){return this._totalPages},enumerable:!0,configurable:!0}),e.prototype.setPageSize=function(e){this._cellsPerPage.equals(e)||this.emptyPageStore(),this._cellsPerPage.set(e),this._pagesPerCell.x=1/e.x,this._pagesPerCell.y=1/e.y},e.prototype.isRequestedDataLoaded=function(e){var t=this,o=!1,r=!e.loadPort.isZero,n=!e.pxLoadPort.isZero;(r||n)&&(o=null===(r?this.cellRangeToPageRange(e.loadPort):this.pxRangeToPageRange(e.pxLoadPort)).first(function(e){return!t._pageLookup.has(e.y*t._totalPages.x+e.x)}));return o},e.prototype.limitPagesToLoad=function(e){for(var t=e.clone(),o=e.toRect(),r=!1,n=o.start.y;n<o.stop.y;n+=1){for(var i=o.start.x;i<o.stop.x;i+=1)if(!this._pageLookup.has(n*this._cellsPerPage.x+i)&&!this._requestedPages.has(n*this._cellsPerPage.x+i)){r=!0;break}if(r)break;t.pos.y+=1,t.size.y-=1}r=!1;for(n=o.stop.y;n>o.start.y;n-=1){for(i=o.start.x;i<o.stop.x;i+=1)if(!this._pageLookup.has(n*this._cellsPerPage.x+i)&&!this._requestedPages.has(n*this._cellsPerPage.x+i)){r=!0;break}if(r)break;t.size.y-=1}r=!1;for(n=o.start.x;n<o.stop.x;n+=1){for(i=o.start.y;i<o.stop.y;i+=1)if(!this._pageLookup.has(i*this._cellsPerPage.x+n)&&!this._requestedPages.has(i*this._cellsPerPage.x+n)){r=!0;break}if(r)break;t.pos.x+=1,t.size.x-=1}r=!1;for(n=o.stop.x;n>o.start.x;n-=1){for(i=o.start.y;i<o.stop.y;i+=1)if(!this._pageLookup.has(i*this._cellsPerPage.x+n)&&!this._requestedPages.has(i*this._cellsPerPage.x+n)){r=!0;break}if(r)break;t.size.x-=1}return t},e.prototype.cellSpaceToPageSpaceX=function(e){return e/this._cellsPerPage.x|0},e.prototype.cellSpaceToPageSpaceY=function(e){return e/this._cellsPerPage.y|0},e.prototype.cellSpaceToInnerPageSpaceX=function(e){return e-this._cellsPerPage.x*this.cellSpaceToPageSpaceX(e)},e.prototype.cellSpaceToInnerPageSpaceY=function(e){return e-this._cellsPerPage.y*this.cellSpaceToPageSpaceY(e)},e.prototype.pxRangeToPageRange=function(e){t.Util.assert(!!this._pagePxRanges.x&&!!this._pagePxRanges.y,"pagePxRanges does not contain valid ranges");var o=e.pos.x,r=t.Arr.binarySearch(this._pagePxRanges.x,function(e){return e.p+e.s<=o?-1:e.p>o?1:0}),n=e.pos.y,i=t.Arr.binarySearch(this._pagePxRanges.y,function(e){return e.p+e.s<=n?-1:e.p>n?1:0}),a=e.pos.x+e.size.x-1,s=t.Arr.binarySearch(this._pagePxRanges.x,function(e){return e.p+e.s<=a?-1:e.p>a?1:0}),c=e.pos.y+e.size.y-1,l=t.Arr.binarySearch(this._pagePxRanges.y,function(e){return e.p+e.s<=c?-1:e.p>c?1:0});return new t.Rect(r,i,s,l,!0).toRange2()},e.prototype.cellRangeToPageRange=function(e){var o=(new t.Range2).set(e),r=o.toRect(!1,this._dummyRect).translate(this._pagesPerCell);return r.start.toInt(),r.stop.ceil(),r.toRange2(o),o},e.prototype.pageRangeToCellRange=function(e){return(new t.Range2).set(e).translate(this._cellsPerPage).toInt()},e.prototype.pxRangeToCellRange=function(e){var o=this.pxRangeToPageRange(e),r=this.getDataPagesForPageRange(o),n=r[0].pxScope.start.clone(),i=0;t.Arr.until(r[0].r[0].c,function(t,o){return e.pos.x<n.x+t.w},function(e,t){n.x+=e.w,++i});var a=0;t.Arr.until(r[0].r,function(t,o){return e.pos.y<n.y+t.h},function(e,t){n.y+=e.h,++a}),n=r[r.length-1].pxScope.start.clone();var s=0;t.Arr.until(r[r.length-1].r[0].c,function(t,o){return e.pos.x+e.size.x-1<n.x+t.w},function(e,t){n.x+=e.w,++s});var c=0;t.Arr.until(r[r.length-1].r,function(t,o){return e.pos.y+e.size.y-1<n.y+t.h},function(e,t){n.y+=e.h,++c});var l=r[0].r[a].c[i].i,u=r[r.length-1].r[c].c[s].i;return new t.Rect(l.x,l.y,u.x,u.y,!0).toRange2()},e.prototype.addDataToPageStore=function(e,t){var o=this;this.partitionDataIntoPages(t.r,t.dataPort,t.pxScope).forEach(function(e){return o.insertPage(e)}),this.cleanPageStore(e)},e.prototype.readPropertiesFromResponse=function(e){this._totalCells.equals(e.totalCells)||(this._totalPages.set(e.totalCells).scale(this._pagesPerCell),this._totalCells.set(e.totalCells),this._usePx&&this._totalPx.set(e.totalPx))},e.prototype.emptyPageStore=function(){for(;this._pageQueue.length>0;)this.shiftPageQueue()},e.prototype.cleanPageStore=function(e){var o=this,r=this.calculateLockedPages(e),n=Math.max(this._retainSize,r.list.count);t.Arr.reverse(this._pageQueue),t.Arr.reverseUntil(this._pageQueue,function(e,t){return o._pageQueue.length<=n},function(e,t){r.has(""+o._pageQueue[t].id)||o.removePageFromQueue(o._pageQueue[t])}),t.Arr.reverse(this._pageQueue)},e.prototype.removePageFromQueue=function(e){t.Arr.remove(this._pageQueue,e),this.deletePageById(e.id),e.release()},e.prototype.shiftPageQueue=function(){var e=this._pageQueue.shift();this.deletePageById(e.id),e.release()},e.prototype.deletePageById=function(e){this._pageLookup.has(e)&&this._pageLookup.delete(e)},e.prototype.partitionDataIntoPages=function(e,t,o){for(var r=this.cellRangeToPageRange(t).toRect(),n=new Array,i=0,a=r.start.y;a<r.stop.y;++a){for(var s=0,c=r.start.x;c<r.stop.x;++c){var l=a*this._totalPages.x+c;if(!this._pageLookup.has(l)){var u=this._pagePool.get();if(u.id=l,u.cellSize=this._cellsPerPage,this._usePx){var p=this._pagePxRanges.x[c],h=this._pagePxRanges.y[a],g=u.pxScope;g.start.x=p.p,g.start.y=h.p,g.stop.x=p.p+p.s-1,g.stop.y=h.p+h.s-1}n.push(u);for(var P=i*this._cellsPerPage.y,f=s*this._cellsPerPage.x,d=P+this._cellsPerPage.y,y=f+this._cellsPerPage.x,x=0,_=P;_<d&&_<e.length;++_){var b=e[_],w=u.r[x];w.h=b.h,w.i=b.i,w.d=b.d;for(var R=0,m=f;m<y&&m<b.c.length;++m)w.c[R]=b.c[m],++R;++x}}++s}++i}return n},e.prototype.insertPage=function(e){!this._pageLookup.has(e.id)||t.Arr.removeOneByFn(this._pageQueue,function(t){return t.id===e.id}),this._pageQueue.push(e),this._pageLookup.set(e.id,e)},e.prototype.calculateLockedPages=function(e){var o=this,r=new t.Dictionary;return t.Arr.forEach(t.Arr.flatten(t.Arr.map(e,function(e){return o.getPageIdsForViewPort(e.loadPort)})),function(e){return r.set(e,e)}),r},e.prototype.assembleDataFromPages=function(e){var o=new Array,r=this.getLoadPort(e);t.Util.loop(r.size.y,function(e){return o.push(new p(r.size.x))});var n,i=this.getDataPages(e),a=r.toRect(),s=this.cellRangeToPageRange(r),c=new t.Vec2,l=new t.Vec2,u=new t.Vec2,h=new t.Vec2,g=o.length,P=void 0===o[0]?0:o[0].c.length,f=new t.Vec2;for(c.y=a.start.y;c.y<a.stop.y&&l.y<g;c.y+=1,l.y+=1){u.y=this.cellSpaceToPageSpaceY(c.y),l.x=0,h.y=this.cellSpaceToInnerPageSpaceY(c.y),f.set(u).subtract(s.pos);var d=i[n=f.y*s.size.x+f.x].r[h.y];for(o[l.y].init({i:d.i,h:d.h,d:d.d}),c.x=a.start.x;c.x<a.stop.x&&l.x<P;c.x+=1,l.x+=1)u.x=this.cellSpaceToPageSpaceX(c.x),h.x=this.cellSpaceToInnerPageSpaceX(c.x),h.y=this.cellSpaceToInnerPageSpaceY(c.y),f.set(u).subtract(s.pos),n=f.y*s.size.x+f.x,o[l.y].c[l.x]=i[n].r[h.y].c[h.x]}return o},e.prototype.getPageIdsForViewPort=function(e){var t=this,o=[];return this.cellRangeToPageRange(e).forEach(function(e){var r=e.y*t._cellsPerPage.x+e.x;return t._pageLookup.has(r)&&o.push(t._pageLookup.get(r).id),!1}),o},e.prototype.getLoadPort=function(e){return!e.loadPort.isZero?e.loadPort:this.pxRangeToCellRange(e.pxLoadPort)},e.prototype.getDataPages=function(e){return!e.loadPort.isZero?this.getDataPagesForCellPort(e.loadPort):this.getDataPagesForPxPort(e.pxLoadPort)},e.prototype.getDataPagesForCellPort=function(e){var t=this.cellRangeToPageRange(e);return this.getDataPagesForPageRange(t)},e.prototype.getDataPagesForPxPort=function(e){var t=this.pxRangeToPageRange(e);return this.getDataPagesForPageRange(t)},e.prototype.getDataPagesForPageRange=function(e){var t=this,o=new Array;return e.forEach(function(e){var r=e.y*t._totalPages.x+e.x;return t._pageLookup.has(r)&&o.push(t._pageLookup.get(r)),!1}),o},e}(),d=function(){function e(o){this.isDebug=!0,this._id=t.Util.newUUID(),this._usePx=!0,this._requestCounter=0,this._handleCounter=0,this._callers=[],this._pageStore=null,this._endPointFn=o.endPointFn?o.endPointFn:e.DEFAULT_CONFIG.endPointFn,this._pageStore=new f(o.pageSize||e.DEFAULT_CONFIG.pageSize,o.retainSize?o.retainSize:e.DEFAULT_CONFIG.retainSize,o.pagePxRanges)}return e.prototype.load=function(e,o){var r=this;void 0===o&&(o=!1),t.Util.assert(t.Test.isFunction(this._endPointFn),"EndPoint is valid function",this.isDebug),t.Util.assert(void 0!==e.viewPort,"ViewPort is defined",this.isDebug),(this.loadPortHasChanged(e)||o)&&(e.limitLoadPortByTotalCells(),e.limitPxLoadPortByTotalPx(),this._pageStore.isRequestedDataLoaded(e)?(this.addDataToStream(e,o),this._pageStore.cleanPageStore(this._callers)):e.fetchSubscription=this.fetchData(e).subscribe(function(n){t.Util.assert(void 0!==n,"Payload from server was empty in DataStore.load()",r.isDebug)&&(r.readPropertiesFromResponse(e,n),e.limitLoadPortByTotalCells(),e.limitPxLoadPortByTotalPx(),r._pageStore.addDataToPageStore(r._callers,n),e.ignoreFetch<e.requestId&&r.addDataToStream(e,o))},function(t){e.cancelOngoingFetch(),r.onDataFail(e,t)}))},e.prototype.loadPortHasChanged=function(e){var t=e.loadPort,o=e.pxLoadPort;return!t.isZero&&!t.equals(e.fixedLoadPort)||!o.isZero&&!o.equals(e.fixedPxLoadPort)},e.prototype.readPropertiesFromResponse=function(e,o){e.totalCells=(new t.Vec2).set(o.totalCells),this._usePx=!!o.pxScope,this._usePx&&e.totalPx.set(o.totalPx),o.cellsPerPage&&this._pageStore.setPageSize(o.cellsPerPage),this._pageStore.readPropertiesFromResponse(o)},e.prototype.register=function(e){var t=new n(this._handleCounter,this,e);return this._handleCounter+=1,this._callers.push(t.internal),t},e.prototype.fetchData=function(e){var t=this.createRequestDTO(e);return e.requestId=this._requestCounter,e.cancelOngoingFetch(),this._endPointFn(t)},e.prototype.createRequestDTO=function(e){var t,o=null;o=e.pxViewPort.isZero?this._pageStore.cellRangeToPageRange(e.loadPort):this._pageStore.pxRangeToPageRange(e.pxLoadPort),o=this._pageStore.limitPagesToLoad(o),t=this._pageStore.pageRangeToCellRange(o);var r=(new c).init({sourceId:this._id,requestId:this._requestCounter,cellRequest:t});return this._requestCounter+=1,r},e.prototype.onDataFail=function(e,t){throw new Error("Not Implemented")},e.prototype.addDataToStream=function(e,t){if(void 0===t&&(t=!1),!this.viewPortIsAlreadyStreamed(e)||t){e.fixLoadPort();var o=this._pageStore.getLoadPort(e),r=this._pageStore.assembleDataFromPages(e),n=null;this._usePx&&(n=this.calculatePxRangeFromCellRange(o));var i=new a;i.init({totalCells:this._pageStore.totalCells,totalPx:this._pageStore.totalPx,loadPort:o,rows:r,pxScope:n}),e.stream.next(i)}},e.prototype.viewPortIsAlreadyStreamed=function(e){return!e.viewPort.isZero&&e.fixedLoadPort.contains(e.viewPort)||!e.pxViewPort.isZero&&e.fixedPxLoadPort.contains(e.pxViewPort)},e.prototype.calculatePxRangeFromCellRange=function(e){var o=new t.Rect,r=this._pageStore.getDataPagesForCellPort(e),n=e.toRect(),i=r[0].pxScope.start.clone(),a=r[r.length-1].pxScope.stop.clone(),s=r[0].r[0].c[0].i.x,c=r[0].r[0].c[r[0].r[0].c.length-1].i.x,l=r[0].r[0].i,u=(r[r.length-1].r[r[r.length-1].r.length-1].i,t.Arr.shallowCopy(r[0].r[0].c));t.Arr.until(u,function(e,t){return t+s>=n.start.x},function(e,t){return i.x+=e.w}),t.Arr.reverse(u),t.Arr.until(u,function(e,t){return c-t>=n.start.x},function(e,t){return a.x-=e.w});var p=t.Arr.shallowCopy(r[0].r);return t.Arr.until(p,function(e,t){return t+l>=n.start.y},function(e,t){return i.y+=e.h}),t.Arr.reverse(p),t.Arr.until(p,function(e,t){return c-t>=n.start.y},function(e,t){return a.y-=e.h}),o.start=i,o.stop=a,o},e.DEFAULT_CONFIG={pageSize:new t.Vec2(10,10),retainSize:10,endPointFn:null},e}(),y=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},x=function(){function e(){this._viewPort=new t.Range2,this._pxViewPort=new t.Range2,this._requestMargin=new t.Vec2(0,0),this._loadPort=new t.Range2,this._pxLoadPort=new t.Range2,this._pxRequestMargin=new t.Vec2(0,0)}return e.prototype.init=function(e){throw new Error("Method not implemented.")},Object.defineProperty(e.prototype,"viewPort",{get:function(){return this._viewPort},set:function(e){this._viewPort.set(e),this._loadPort=this.calculateLoadPort(this._viewPort,this._requestMargin),this._pxViewPort.zero(),this._pxLoadPort.zero()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestMargin",{get:function(){return this._requestMargin},set:function(e){this._requestMargin.set(e),this._loadPort=this.calculateLoadPort(this._viewPort,this._requestMargin)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxViewPort",{get:function(){return this._pxViewPort},set:function(e){this._pxViewPort.set(e),this._pxLoadPort=this.calculateLoadPort(this._pxViewPort,this._pxRequestMargin),this._viewPort.zero(),this._loadPort.zero()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxRequestMargin",{get:function(){return this._pxRequestMargin},set:function(e){this._pxRequestMargin.set(e),this._pxLoadPort=this.calculateLoadPort(this._pxViewPort,this._pxRequestMargin)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadPort",{get:function(){return this._loadPort},set:function(e){this._loadPort.set(e),this._pxLoadPort.zero()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pxLoadPort",{get:function(){return this._pxLoadPort},set:function(e){this._pxLoadPort.set(e),this._loadPort.zero()},enumerable:!0,configurable:!0}),e.prototype.calculateLoadPort=function(e,t){var o=e.clone();o.pos.subtract(t),o.size.add(t.clone().multiply(2));var r=o.pos.clone().invert().max({x:0,y:0});return o.pos.add(r),o.size.subtract(r),o},e=y([t.Initable],e)}();return e.DataStore=d,e.DataStoreConsumable=a,e.DataStoreRequestDto=c,e.RequestConfig=x,e}({},goodcore,BehaviorSubject);
//# sourceMappingURL=goodstore.es5.iife.min.js.map
